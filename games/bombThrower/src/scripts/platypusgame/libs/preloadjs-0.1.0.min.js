/**
* PreloadJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2012 Grant Skinner
* 
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
* 
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
**/
(function(f){function c(){}c.init=function(){var a=navigator.userAgent;this.isFirefox=a.indexOf("Firefox")>-1;this.isOpera=f.opera!=null;this.isIOS=a.indexOf("iPod")>-1||a.indexOf("iPhone")>-1||a.indexOf("iPad")>-1};c.init();f.BrowserDetect=c})(window);(function(f){var c=function(){this.init()};c.prototype={};var a=c.prototype;a.loaded=false;a.progress=0;a._item=null;a.onProgress=null;a.onLoadStart=null;a.onFileLoad=null;a.onFileLoad=null;a.onComplete=null;a.onFileError=null;a.getItem=function(){return this._item};a.init=function(){};a.load=function(){};a.cancel=function(){};a._sendLoadStart=function(){if(this.onLoadStart)this.onLoadStart({target:this})};a._sendProgress=function(b){var a;if(b instanceof Number)this.progress=b,a={loaded:this.progress,
total:1};else if(a=b,this.progress=b.loaded/b.total,isNaN(this.progress)||this.progress==Infinity)this.progress=0;a.target=this;if(this.onProgress)this.onProgress(a)};a._sendFileProgress=function(b){if(this.onFileProgress)b.target=this,this.onFileProgress(b)};a._sendComplete=function(){if(this.onComplete)this.onComplete({target:this})};a._sendFileComplete=function(b){if(this.onFileLoad)b.target=this,this.onFileLoad(b)};a._sendError=function(b){if(this.onError)b==null&&(b={}),b.target=this,this.onError(b)};
a.toString=function(){return"[PreloadJS AbstractLoader]"};f.AbstractLoader=c})(window);(function(f){var c=function(b){this.initialize(b)},a=c.prototype=new AbstractLoader;c.IMAGE="image";c.SOUND="sound";c.JSON="json";c.JAVASCRIPT="javascript";c.CSS="css";c.XML="xml";c.TEXT="text";c.TIMEOUT_TIME=8E3;a.useXHR=true;a.async=false;a.stopOnError=false;a.maintainScriptOrder=true;a.next=null;a.onItemProgress=null;a.typeHandlers=null;a.extensionHandlers=null;a._maxLoads=1;a._currentLoads=null;a._loadQueue=null;a._loadedItemsById=null;a._loadedItemsBySrc=null;a._targetProgress=0;a._numItems=
0;a._numItemsLoaded=null;a._scriptOrder=null;a._loadedScripts=null;a.TAG_LOAD_OGGS=true;a.initialize=function(b){this._targetProgress=this._numItemsLoaded=this._numItems=0;this._paused=false;this._currentLoads=[];this._loadQueue=[];this._scriptOrder=[];this._loadedScripts=[];this._loadedItemsById={};this._loadedItemsBySrc={};this.typeHandlers={};this.extensionHandlers={};this.useXHR=b!=false&&f.XMLHttpRequest!=null;this.determineCapabilities()};a.determineCapabilities=function(){var b=BrowserDetect;
if(b!=null)c.TAG_LOAD_OGGS=b.isFirefox||b.isOpera};c.isBinary=function(b){switch(b){case c.IMAGE:case c.SOUND:return true;default:return false}};a.installPlugin=function(b){if(!(b==null||b.getPreloadHandlers==null)){b=b.getPreloadHandlers();if(b.types!=null)for(var a=0,c=b.types.length;a<c;a++)this.typeHandlers[b.types[a]]=b.callback;if(b.extensions!=null)for(a=0,c=b.extensions.length;a<c;a++)this.extensionHandlers[b.extensions[a]]=b.callback}};a.setMaxLoads=function(b){this._maxLoads=b;this._paused||
this._loadNext()};a.loadFile=function(b,a){this._addItem(b);(a===void 0||a==true)&&this.setPaused(false)};a.loadManifest=function(b,a){var c;b instanceof Array?c=b:b instanceof Object&&(c=[b]);for(var e=0,f=c.length;e<f;e++)this._addItem(c[e]);a!=false&&this._loadNext()};a.load=function(){this.setPaused(false)};a.getResult=function(b){return this._loadedItemsById[b]||this._loadedItemsBySrc[b]};a.setPaused=function(b){(this._paused=b)||this._loadNext()};a.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();
this._currentLoads=[];this._scriptOrder=[];this._loadedScripts=[]};a._addItem=function(b){b=this._createLoadItem(b);b!=null&&(this._loadQueue.push(b),this._numItems++,this._updateProgress(),b.getItem().type==c.JAVASCRIPT&&(this._scriptOrder.push(b.getItem()),this._loadedScripts.push(null)))};a._loadNext=function(){if(!this._paused){this._loadQueue.length==0&&(this._sendComplete(),this.next&&this.next.load&&this.next.load.apply(this.next));for(;this._loadQueue.length&&this._currentLoads.length<this._maxLoads;){var b=
this._loadQueue.shift();b.onProgress=c.proxy(this._handleProgress,this);b.onComplete=c.proxy(this._handleFileComplete,this);b.onError=c.proxy(this._handleFileError,this);this._currentLoads.push(b);b.load()}}};a._handleFileError=function(b){var b=b.target,a=this._createResultData(b.getItem());this._numItemsLoaded++;this._updateProgress();this._sendError(a);this.stopOnError||(this._removeLoadItem(b),this._loadNext())};a._createResultData=function(b){return{id:b.id,result:null,data:b.data,type:b.type,
src:b.src}};a._handleFileComplete=function(b){this._numItemsLoaded++;var b=b.target,a=b.getItem();this._removeLoadItem(b);var d=this._createResultData(a);d.result=b instanceof c.lib.XHRLoader?this._createResult(a,b.getResult()):a.tag;this._loadedItemsById[a.id]=d;this._loadedItemsBySrc[a.src]=d;var e=this;switch(a.type){case c.IMAGE:if(b instanceof c.lib.XHRLoader){d.result.onload=function(){e._handleFileTagComplete(a,d)};return}break;case c.JAVASCRIPT:if(this.maintainScriptOrder){this._loadedScripts[this._scriptOrder.indexOf(a)]=
a;this._checkScriptLoadOrder();return}}this._handleFileTagComplete(a,d)};a._checkScriptLoadOrder=function(){for(var b=this._loadedScripts.length,a=0;a<b;a++){var c=this._loadedScripts[a];if(c===null)break;if(c!==true){var c=this.getResult(c.src),e=this._createResultData(c);e.result=c.result;this._handleFileTagComplete(c,e);this._loadedScripts[a]=true;a--;b--}}};a._handleFileTagComplete=function(b,a){b.completeHandler&&b.completeHandler(a);this._updateProgress();this._sendFileComplete(a);this._loadNext()};
a._removeLoadItem=function(b){for(var a=this._currentLoads.length,c=0;c<a;c++)if(this._currentLoads[c]==b){this._currentLoads.splice(c,1);break}};a._createResult=function(b,a){var d=null,e;switch(b.type){case c.IMAGE:d=this._createImage();break;case c.SOUND:d=b.tag||this._createAudio();break;case c.CSS:d=this._createLink();break;case c.JAVASCRIPT:d=this._createScript();break;case c.XML:if(f.DOMParser){var g=new DOMParser;g.parseFromString(a,"text/xml")}else g=new ActiveXObject("Microsoft.XMLDOM"),
g.async=false,g.loadXML(a),e=g;break;case c.JSON:case c.TEXT:e=a}return d?(b.type==c.CSS?d.href=b.src:d.src=b.src,d):e};a._handleProgress=function(b){var b=b.target,a=this._createResultData(b.getItem());a.progress=b.progress;this._sendFileProgress(a);this._updateProgress()};a._updateProgress=function(){for(var b=this._numItemsLoaded/this._numItems,a=1/this._numItems,c=0,e=this._currentLoads.length;c<e;c++)b+=this._currentLoads[c].progress*a;this._sendProgress({loaded:b,total:1})};a._createLoadItem=
function(b){var a={};switch(typeof b){case "string":a.src=b;break;case "object":b instanceof HTMLAudioElement?(a.tag=b,a.src=a.tag.src,a.type=c.SOUND):a=b}a.ext=this._getNameAfter(a.src,".");if(!a.type)a.type=this.getType(a.ext);if(a.id==null||a.id=="")a.id=a.src;if(b=this.typeHandlers[a.type]||this.extensionHandlers[a.ext]){b=b(a.src,a.type,a.id,a.data);if(b===false)return null;else if(b!==true){if(b.src!=null)a.src=b.src;if(b.id!=null)a.id=b.id;if(b.tag!=null&&b.tag.load instanceof Function)a.tag=
b.tag}a.ext=this._getNameAfter(a.src,".")}b=this.useXHR;switch(a.type){case c.JSON:case c.XML:case c.TEXT:b=true;break;case c.SOUND:a.ext=="ogg"&&c.TAG_LOAD_OGGS&&(b=false)}if(b)return new c.lib.XHRLoader(a);else if(a.tag)return new c.lib.TagLoader(a);else{var d,b="src",e=false;switch(a.type){case c.IMAGE:d=this._createImage();break;case c.SOUND:d=this._createAudio();break;case c.CSS:b="href";e=true;d=this._createLink();break;case c.JAVASCRIPT:e=true,d=this._createScript()}a.tag=d;return new c.lib.TagLoader(a,
b,e)}};a.getType=function(a){switch(a){case "jpeg":case "jpg":case "gif":case "png":return c.IMAGE;case "ogg":case "mp3":case "wav":return c.SOUND;case "json":return c.JSON;case "xml":return c.XML;case "css":return c.CSS;case "js":return c.JAVASCRIPT;default:return c.TEXT}};a._getNameAfter=function(a,c){var d=a.lastIndexOf(c),d=a.substr(d+1),e=d.lastIndexOf(/[\b|\?|\#|\s]/);return e==-1?d:d.substr(0,e)};a._createImage=function(){return document.createElement("img")};a._createAudio=function(){var a=
document.createElement("audio");a.autoplay=false;a.type="audio/ogg";return a};a._createScript=function(){var a=document.createElement("script");a.type="text/javascript";return a};a._createLink=function(){var a=document.createElement("link");a.type="text/css";a.rel="stylesheet";return a};a.toString=function(){return"[PreloadJS]"};c.proxy=function(a,c){return function(d){return a.apply(c,arguments)}};c.log=function(){};c.lib={};f.PreloadJS=c})(window);(function(){var f=function(a,b,c){this.init(a,b,c)},c=f.prototype=new AbstractLoader;c._srcAttr=null;c._loadTimeOutTimeout=null;c.tagCompleteProxy=null;c.init=function(a,b,c){this._item=a;this._srcAttr=b||"src";this._useXHR=c==true;this.isAudio=a.tag instanceof HTMLAudioElement;this.tagCompleteProxy=PreloadJS.proxy(this._handleTagLoad,this)};c.cancel=function(){this._clean();var a=this.getItem();if(a!=null)a.src=null};c.load=function(){this._useXHR?this.loadXHR():this.loadTag()};c.loadXHR=function(){var a=
this.getItem(),a=new PreloadJS.lib.XHRLoader(a);a.onProgress=PreloadJS.proxy(this._handleProgress,this);a.onFileLoad=PreloadJS.proxy(this._handleXHRComplete,this);a.onFileError=PreloadJS.proxy(this._handleLoadError,this);a.load()};c._handleXHRComplete=function(a){this._clean();var b=a.getItem();a.getResult();b.type==PreloadJS.IMAGE?(b.tag.onload=PreloadJS.proxy(this._sendComplete,this),b.tag.src=b.src):(b.tag[this._srcAttr]=b.src,this._sendComplete())};c._handleLoadError=function(a){this._clean();
this._sendError(a)};c.loadTag=function(){var a=this.getItem(),b=a.tag;clearTimeout(this._loadTimeOutTimeout);this._loadTimeOutTimeout=setTimeout(PreloadJS.proxy(this._handleLoadTimeOut,this),PreloadJS.TIMEOUT_TIME);if(this.isAudio)b.src=null,b.preload="auto",b.setAttribute("data-temp","true");b.onerror=PreloadJS.proxy(this._handleLoadError,this);b.onprogress=PreloadJS.proxy(this._handleProgress,this);this.isAudio?(b.onstalled=PreloadJS.proxy(this._handleStalled,this),b.addEventListener("canplaythrough",
this.tagCompleteProxy)):b.onload=PreloadJS.proxy(this._handleTagLoad,this);b[this._srcAttr]=a.src;a=a.type==PreloadJS.SOUND&&a.ext=="ogg"&&BrowserDetect.isFirefox;b.load!=null&&!a&&b.load()};c._handleLoadTimeOut=function(){this._clean();this._sendError()};c._handleStalled=function(){};c._handleLoadError=function(){this._clean();this._sendError()};c._handleTagLoad=function(){var a=this.getItem().tag;clearTimeout(this._loadTimeOutTimeout);if(!(this.isAudio&&a.readyState!==4)&&!this.loaded)this.loaded=
true,this._clean(),this._sendComplete()};c._clean=function(){clearTimeout(this._loadTimeOutTimeout);var a=this.getItem().tag;a.onload=null;a.removeEventListener("canplaythrough",this.tagCompleteProxy);a.onstalled=null;a.onprogress=null;a.onerror=null};c._handleProgress=function(a){clearTimeout(this._loadTimeOutTimeout);if(this.isAudio){a=this.getItem();if(a.buffered==null)return;a={loaded:a.buffered.length>0?a.buffered.end(0):0,total:a.duration}}this._sendProgress(a)};c.toString=function(){return"[PreloadJS TagLoader]"};
PreloadJS.lib.TagLoader=f})(window);(function(f){var c=function(a){this.init(a)},a=c.prototype=new AbstractLoader;a._wasLoaded=false;a._request=null;a._loadTimeOutTimeout=null;a._xhrLevel=null;a.init=function(a){this._item=a;this._createXHR(a)||PreloadJS.log("Unable to create XHR instance")};a.getResult=function(){try{if(this._request.responseXML)return this._request.responseXML.xml}catch(a){}return this._request.response};a.cancel=function(){this._clean();this._request.abort()};a.load=function(){if(this._request==null)this.handleError();
else{if(this._xhrLevel==1)this._loadTimeOutTimeout=setTimeout(PreloadJS.proxy(this.handleTimeout,this),PreloadJS.TIMEOUT_TIME);this._request.onloadstart=PreloadJS.proxy(this.handleLoadStart,this);this._request.onprogress=PreloadJS.proxy(this.handleProgress,this);this._request.onabort=PreloadJS.proxy(this.handleAbort,this);this._request.onerror=PreloadJS.proxy(this.handleError,this);this._request.ontimeout=PreloadJS.proxy(this.handleTimeout,this);this._request.onload=PreloadJS.proxy(this.handleLoad,
this);this._request.onreadystatechange=PreloadJS.proxy(this.handleReadyStateChange,this);this._request.send()}};a.handleProgress=function(a){a.loaded>0&&a.total==0?this.handleError():this._sendProgress({loaded:a.loaded,total:a.total})};a.handleLoadStart=function(){clearTimeout(this._loadTimeOutTimeout);this._sendLoadStart()};a.handleAbort=function(){this._clean();this._sendError()};a.handleError=function(){this._clean();this._sendError()};a.handleReadyStateChange=function(){this._request.readyState==
4&&this.handleLoad()};a.handleLoad=function(){if(!this.loaded)this.loaded=true,this._checkError()?(this._clean(),this._sendComplete()):this.handleError()};a._checkError=function(){switch(this._request.status){case "404":return false}return this._request.response==null?false:true};a.handleTimeout=function(){this._clean();this._sendError()};a.handleLoadEnd=function(){this._clean()};a._createXHR=function(a){this._xhrLevel=1;if(f.ArrayBuffer)this._xhrLevel=2;if(f.XMLHttpRequest)this._request=new XMLHttpRequest;
else try{this._request=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(c){return null}a.type==PreloadJS.TEXT&&this._request.overrideMimeType("text/plain; charset=x-user-defined");this._request.open("GET",a.src,true);if(PreloadJS.isBinary(a.type))this._request.responseType="arraybuffer";return true};a._clean=function(){clearTimeout(this._loadTimeOutTimeout);var a=this._request;a.onloadstart=null;a.onprogress=null;a.onabort=null;a.onerror=null;a.onload=null;a.ontimeout=null;a.onloadend=null;a.onreadystatechange=
null;clearInterval(this._checkLoadInterval)};a.toString=function(){return"[PreloadJS XHRLoader]"};PreloadJS.lib.XHRLoader=c})(window);
