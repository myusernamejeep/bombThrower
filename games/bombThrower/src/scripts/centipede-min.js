(function Assets(b){Assets.SND_CENTIPEDE="SoundCentipede";Assets.SND_CENTIPEDE_MULTIPLE="SoundCentipedeMultiple";Assets.SND_CENTIPEDE_CRAZY="SoundCentipedeCrazy";Assets.SND_EXPLOSION="SoundExplosion";Assets.SND_SHOOT="SoundShoot";Assets.SND_PLAYER_HIT="PlayerHit";Assets.SND_MUSHROOM_HIT="MushroomHit";Assets.SND_EXTRA_LIFE="SoundExtraLife";Assets.SND_FLEA="SoundFlea";Assets.SND_REPAIR="SoundRepair";Assets.SND_SCORPION="SoundScorpion";Assets.SND_SPIDER="SoundSpider";Assets.SND_GAMESTART="StartGame";
Assets.SND_GAMEOVER="GameOver";Assets.SND_LEVELCOMPLETE="LevelComplete";Assets.TEX_SHOT="Projectile";Assets.TEX_EXPLOSION="Explosion2";Assets.TEX_EXPLOSION_PURPLE="ExplosionPurple";Assets.TEX_DEATH_SMOKE="DeathSmoke";Assets.HUD_GNOME="hudGnome";Assets.TEX_300="Floaty300";Assets.TEX_600="Floaty600";Assets.TEX_900="Floaty900";Assets.TEX_MUSHROOM="MushroomIdle";Assets.TEX_MUSHROOM_MOVE="MushroomMove";Assets.TEX_MUSHROOM_DAMAGE="MushroomDmg";Assets.TEX_MUSHROOM_POISONED="MushroomPoisonIdle";Assets.TEX_MUSHROOM_POISONED_MOVE=
"MushroomMove";Assets.TEX_MUSHROOM_POISONED_DAMAGE="MushroomPoisonDmg";Assets.TEX_PLAYER_IDLE="GnomeIdle";Assets.TEX_PLAYER_WALK_RIGHT="GnomeWalkRight";Assets.TEX_PLAYER_WALK_LEFT="GnomeWalkLeft";Assets.TEX_PLAYER_ATTACK="GnomeAttack";Assets.TEX_PLAYER_DEATH="GnomeDeath";Assets.TEX_FLEA="FleaMove";Assets.TEX_SPIDER_LEFT="SpiderWalkLeft";Assets.TEX_SPIDER_RIGHT="SpiderWalkRight";Assets.TEX_SCORPION="Scorpion";Assets.TEX_CENTI_HEAD="CentipedeWalk";Assets.TEX_CENTI_HEAD_DOWN="CentipedeHeadDown";Assets.TEX_CENTI_BODY=
"CentipedeBodyWalk";Assets.TEX_CENTI_BODY_DOWN="CentipedeBodyDown";Assets.textureSheet;Assets.getBitmap=function(a,b,c){var f=new BitmapAnimation(Assets.textureSheet);c?f.gotoAndPlay(a):f.gotoAndStop(a);f.type=a;if(0!=f.spriteSheet._frameWidth)f.width=f.spriteSheet._frameWidth,f.height=f.spriteSheet._frameHeight;else try{var d=f.spriteSheet._frames[f.currentFrame];f.width=d.rect.width;f.height=d.rect.height}catch(g){throw g;}b?(f.regX=f.width/2,f.regY=f.height/2):(f.regX=0,f.regY=0);return f};Assets.getBitmapAnimation=
function(a,b){var c=Assets.getBitmap(a,b,!0);c.gotoAndPlay(a);return c};Assets.SND_BG1="sounds/sound.mp3";b.currentGame.Assets=Assets})(window.Atari);(function(h){function b(){}b.game=null;b.centipedeNormal=null;b.centipedePoisoned=null;b.centipedeMultiple=null;b.scorpion=null;b.spider=null;b.VOLUME=0.25;b.allSounds=[];b.init=function(a){b.game=a;a=b.centipedeNormal=SoundJS.play(Assets.SND_CENTIPEDE,null,0,0,-1,1,b.VOLUME);a.pause();a._active=!1;b.allSounds.push(a);a=b.centipedePoisoned=SoundJS.play(Assets.SND_CENTIPEDE_CRAZY,null,0,0,-1,1,b.VOLUME);a.pause();a._active=!1;b.allSounds.push(a);a=b.centipedeMultiple=SoundJS.play(Assets.SND_CENTIPEDE_MULTIPLE,
null,0,0,-1,1,b.VOLUME);a.pause();a._active=!1;b.allSounds.push(a);a=b.scorpion=SoundJS.play(Assets.SND_SCORPION,null,0,0,-1,1,b.VOLUME);a.pause();a._active=!1;b.allSounds.push(a);a=b.spider=SoundJS.play(Assets.SND_SPIDER,null,0,0,-1,1,b.VOLUME);a.pause();a._active=!1;b.allSounds.push(a)};b.pause=function(){for(var a=0,e=b.allSounds.length;a<e;a++){var c=b.allSounds[a];c._active&&c.pause()}};b.resume=function(){for(var a=0,e=b.allSounds.length;a<e;a++){var c=b.allSounds[a];c._active&&c.resume()}};
b.stop=function(){Atari.trace("[BackgroundSound] Stop All");for(var a=0,e=b.allSounds.length;a<e;a++){var c=b.allSounds[a];c._active=!1;c.stop()}this.allSounds.length=0};b.update=function(){for(var a=b.game.centipedeList,e=!1,c=0,f=a.length;c<f;c++)if(a[c].head.isPoisoned){e=!0;break}e?(b.centipedeMultiple._active&&b.centipedeMultiple.pause(),b.centipedeMultiple._active=!1,b.centipedeNormal._active&&b.centipedeNormal.pause(),b.centipedeNormal._active=!1,!b.centipedePoisoned&&b.centipedePoisoned.resume(),
b.centipedePoisoned._active=!0):1<a.length?(b.centipedePoisoned._active&&b.centipedePoisoned.pause(),b.centipedePoisoned._active=!1,b.centipedeNormal._active&&b.centipedeNormal.pause(),b.centipedeNormal._active=!1,!b.centipedeMultiple._active&&b.centipedeMultiple.resume(),b.centipedeMultiple._active=!0):1==a.length?(b.centipedePoisoned._active&&b.centipedePoisoned.pause(),b.centipedePoisoned._active=!1,b.centipedeMultiple._active&&b.centipedeMultiple.pause(),b.centipedeMultiple._active=!1,!b.centipedeNormal._active&&
b.centipedeNormal.resume(),b.centipedeNormal._active=!0):(b.centipedeNormal._active&&b.centipedeNormal.pause(),b.centipedeNormal._active=!1,b.centipedePoisoned._active&&b.centipedePoisoned.pause(),b.centipedePoisoned._active=!1,!b.centipedeMultiple._active&&b.centipedeMultiple.pause(),b.centipedeMultiple._active=!0);null!=b.game.currentScorpion?b.scorpion._active||(b.scorpion.setPosition(0),b.scorpion.resume(),b.scorpion._active=!0):b.scorpion._active&&(b.scorpion.pause(),b.scorpion._active=!1);null!=
b.game.currentSpider?b.spider._active||(b.spider.setPosition(0),b.spider.resume(),b.spider._active=!0):b.spider._active&&(b.spider.pause(),b.spider._active=!1)};b.onFleaComplete=function(){b.isFleaPlaying=!1};h.BackgroundSound=b})(window.Atari.currentGame);(function(h){var b=function(f,a){this.initialize(f,a)},a=h.currentGame,e=a.Assets;b.fastSpeed=10;b.normalSpeed=8;var c=b.prototype;c.display;c.vtDir;c.hzDir;c.currentDir;c.turnPoints;c.nextPoint;c.isPoisoned;c.bg;c.stage;c.speed;c.turnHistory;c.numSegments;c.hitBox;c.x;c.y;c.initialize=function(f,d){this.bg=d;this.stage=f;var g=Math.min(d.MAX_SPEED,2*(a.globalLevel-1));b.normalSpeed=8+g;b.fastSpeed=11+g;this.display=e.getBitmapAnimation(e.TEX_CENTI_HEAD,!0);this.display.regY-=0;this.stage.addChild(this.display);
this.vtDir="down";this.hzDir=0.5<Math.random()?"left":"right";this.turnPoints=[];this.turnHistory=[];this.speed=b.normalSpeed;this.isPoisoned=!1;this.setCurrentDir("down");this.hitBox=new Rectangle(0,0,d.rowWidth,d.rowHeight)};c.onAnimationComplete=function(){this.display.currentAnimation==e.TEX_CENTI_HEAD&&this.display.gotoAndPlay(e.TEX_CENTI_HEAD)};c.setFastMode=function(a){this.speed=!a?b.normalSpeed:b.fastSpeed};c.positionAtTop=function(){var f=this.bg.getGridPoint(a.width/2,0);this.display.x=
f.x;this.display.y=f.y;this.hitBox.x=f.x-0.5*this.bg.rowHeight;this.hitBox.y=f.x-0.5*this.bg.rowHeight;this.nextPoint=new Point(f.x,f.y+4*this.bg.rowHeight);this.nextPoint.dir=this.hzDir;f={dir:this.hzDir,x:this.nextPoint.x,y:this.nextPoint.y};f.x+="left"==this.hzDir?-this.bg.rowWidth:this.bg.rowWidth;this.turnPoints=[f];this.turnHistory=[]};c.setCurrentDir=function(a){this.currentDir=a;this.display.scaleX=this.display.scaleY=1;"left"==a||"right"==a?(this.display.scaleX="left"==a?-1:1,this.display.currentAnimation==
e.TEX_CENTI_HEAD_DOWN&&this.display.gotoAndPlay(e.TEX_CENTI_HEAD)):(this.display.scaleY="up"==a?-1:1,this.display.currentAnimation==e.TEX_CENTI_HEAD&&this.display.gotoAndStop(e.TEX_CENTI_HEAD_DOWN))};c.tick=function(a){this.advance(this.speed*a);if(this.isTargetReached()){var a=Math.abs(this.nextPoint.x-this.display.x),d=Math.abs(this.nextPoint.y-this.display.y),a=a+d;this.display.x=this.nextPoint.x;this.display.y=this.nextPoint.y;var g;this.turnPoints&&0<this.turnPoints.length?(d=this.turnPoints.shift(),
0==this.turnPoints.length&&(this.turnPoints=null),g=d.dir!=this.currentDir,this.setCurrentDir(d.dir),this.setNextPoint(d),this.isTurning=!0):this.isTurning=!1;this.isTurning||((this.turnPoints=this.checkForTurn())?(d=this.turnPoints.shift(),g=d.dir!=this.currentDir,this.setNextPoint(d),this.setCurrentDir(this.nextPoint.dir)):this.nextPoint.x="right"==this.currentDir?this.nextPoint.x+this.bg.rowWidth:this.nextPoint.x-this.bg.rowWidth);"right"==this.currentDir?this.display.x+=a:"left"==this.currentDir?
this.display.x-=a:"down"==this.currentDir?this.display.y+=a:"up"==this.currentDir&&(this.display.y-=a);0<this.numSegments&&g&&this.turnHistory.push({x:this.display.x,y:this.display.y,dir:this.currentDir})}this.x=this.display.x;this.y=this.display.y;this.hitBox.x=this.display.x-0.5*this.bg.rowWidth;this.hitBox.y=this.display.y-0.5*this.bg.rowHeight};c.getTurnByIndex=function(a){return this.turnHistory[a]};c.setNextPoint=function(a){this.nextPoint=a};c.checkForTurn=function(){var f=this.isPoisoned;
if("right"==this.currentDir){var d=this.bg.getMushroomByPosition(this.display.x+this.bg.rowWidth,this.display.y);d&&d.isPoisoned&&(this.isPoisoned=!0);if(d||this.display.x+this.bg.rowWidth>a.width-this.bg.rowWidth/2)f=!0}else if("left"==this.currentDir){if((d=this.bg.getMushroomByPosition(this.display.x-this.bg.rowWidth,this.display.y))&&d.isPoisoned)this.isPoisoned=!0;if(d||0>this.display.x-this.bg.rowWidth)f=!0}if(!f)return null;"down"==this.vtDir&&this.display.y>=a.height-this.bg.rowHeight&&(this.vtDir=
"up");"up"==this.vtDir&&this.display.y<=this.bg.minPlayerY+this.bg.rowHeight&&(this.vtDir="down");this.isPoisoned&&this.display.y>=this.bg.minPlayerY&&(this.isPoisoned=!1);var d=this.nextPoint,f=this.bg.rowWidth,g=this.bg.rowHeight,d="down"==this.vtDir?{dir:"down",x:d.x,y:d.y+g}:{dir:"up",x:d.x,y:d.y-g},f="left"==this.hzDir?{dir:"right",x:d.x+f,y:d.y}:{dir:"left",x:d.x-f,y:d.y};this.hzDir=f.dir;return[d,f]};c.advance=function(a){"left"==this.currentDir?this.display.x-=a:"right"==this.currentDir?this.display.x+=
a:this.display.y="down"==this.currentDir?this.display.y+a:this.display.y-a;this.hitBox.x=this.display.x-0.5*this.bg.rowWidth;this.hitBox.y=this.display.y-0.5*this.bg.rowHeight};c.isTargetReached=function(){if(!this.nextPoint)return!1;var a=!1;"left"==this.currentDir&&this.display.x<=this.nextPoint.x?a=!0:"right"==this.currentDir&&this.display.x>=this.nextPoint.x?a=!0:"down"==this.currentDir&&this.display.y>=this.nextPoint.y?a=!0:"up"==this.currentDir&&this.display.y<=this.nextPoint.y&&(a=!0);return a};
c.destroy=function(){this.stage.removeChild(this.display);this.moveHistory=[]};h.currentGame.CentipedeHead=b})(window.Atari);(function(h){var b=function(){},a=h.currentGame,e=a.Assets,c=b.prototype;c.stage;c.bg;c.head;c.isDead;c.segmentList;c.speed;c.initialize=function(a,d){this.bg=d;this.stage=a;this.segmentList=[];this.isDead=!1;this.horizonY=3*this.bg.rowHeight;this.segmentWidth=31};c.tick=function(a){0==this.segmentList.length&&this.head.setFastMode(!0);var d=this.head.speed*a;this.head.tick(a);this.head.display.y>this.horizonY&&0==this.head.display.alpha&&Tween.get(this.head.display).to({alpha:1},500);for(var g=0,
c=this.segmentList.length;g<c;g++){var a=this.segmentList[g],n=a.currentDir;this.advanceSegment(a,d);var b=!1,e;this.head.turnHistory.length>a.turnCount&&(e=this.head.turnHistory[a.turnCount],null==e&&Atari.trace(a.turnCount,":",this.head.turnHistory),"left"==n&&a.x<=e.x?b=!0:"right"==n&&a.x>=e.x?b=!0:"down"==n&&a.y>=e.y?b=!0:"up"==n&&a.y<=e.y&&(b=!0));if(b&&(a.x=e.x,a.y=e.y,a.hitBox.x=a.x-0.5*this.bg.rowWidth,a.hitBox.y=a.y-0.5*this.bg.rowHeight,a.turnCount++,this.setSegmentDir(a,e.dir),("left"==
e.dir||"right"==e.dir)&&e.y==this.head.y))0==g?(n=this.head.currentDir,b=this.head.display):(n=this.segmentList[g-1].currentDir,b=this.segmentList[g-1]),a.x=b.x+("left"==n?this.segmentWidth:-this.segmentWidth)}};c.advanceSegment=function(a,d){"left"==a.currentDir?a.x-=d:"right"==a.currentDir?a.x+=d:a.y="down"==a.currentDir?a.y+d:a.y-d;a.y>this.horizonY&&0==a.alpha&&Tween.get(a).to({alpha:1},500);a.hitBox.x=a.x-0.5*this.bg.rowWidth;a.hitBox.y=a.y-0.5*this.bg.rowHeight};c.createFromScratch=function(c,
d,g,j){this.head=new a.CentipedeHead(this.stage,this.bg);this.head.display.alpha=0;this.head.display.x=d;this.head.display.y=g;!0==j&&this.head.positionAtTop();this.head.numSegments=c;0<c?this.addSegments(c):this.segmentList=[]};c.addSegments=function(a){var d="x",g=-1,c=this.head.display.width,n=this.head.currentDir;"up"==n||"down"==n?(d="y",c=0.6*this.head.display.height,"up"==n&&(g=1)):"right"==n&&(g=1);for(var b=0;b<a;b++){var i=e.getBitmapAnimation(e.TEX_CENTI_BODY,!0);i.regY-=4;var h=new Point(this.head.display.x,
this.head.display.y);0<b?(h.x=this.segmentList[b-1].x,h.y=this.segmentList[b-1].y,i.next=this.segmentList[b-1]):i.next=this.head;this.segmentList.length>b+1&&(i.prev=this.segmentList[b+1]);i.alpha=0;i.x=this.head.display.x;i.y=this.head.display.y;i.hitBox=new Rectangle(i.x-0.5*this.bg.rowWidth,i.y-0.5*this.bg.rowHeight,this.bg.rowWidth,this.bg.rowHeight);i[d]+=c*(b+1)*g;i.turnCount=0;this.stage.addChildAt(i,0);this.segmentList.push(i);this.setSegmentDir(i,n)}};c.createFromCorpse=function(c,d){var g=
c.shift();this.stage.removeChild(g);var j=d.turnHistory;this.head=new a.CentipedeHead(this.stage,this.bg);this.head.display.x=g.x;this.head.display.y=g.y;this.head.turnHistory=[];var b=Math.max(0,g.turnCount);Math.max(0,c.length?c[c.length-1].turnCount:b);var e;for(e=0;e<b;e++)j[e]&&this.head.turnHistory.push(j[e]);this.head.numSegments=c.length;this.segmentList=c;b=this.bg.getGridPoint(g.x,g.y);j=b.x;b=b.y;switch(g.currentDir){case "left":j-=this.bg.rowWidth;break;case "right":j+=this.bg.rowWidth}this.head.setCurrentDir(g.currentDir);
this.head.nextPoint={x:j,y:b};this.head.turnHistory.push({x:this.head.display.x,y:this.head.display.y,dir:this.head.currentDir});"left"==g.currentDir||"right"==g.currentDir?(b={dir:"down",x:j,y:b+this.bg.rowHeight},this.head.turnPoints=[b,"left"==g.currentDir?{dir:"right",x:j+this.bg.rowWidth,y:b.y}:{dir:"left",x:j-this.bg.rowWidth,y:b.y}]):"down"==g.currentDir&&(b={dir:j>h.currentGame.width?"right":"left",x:j,y:b},this.head.turnPoints=[b])};c.setSegmentDir=function(a,d){a.scaleX=a.scaleY=1;a.currentDir=
d;"left"==d||"right"==d?(a.scaleX="left"==d?-1:1,a.currentAnimation==e.TEX_CENTI_BODY_DOWN&&a.gotoAndPlay(e.TEX_CENTI_BODY)):(a.scaleY="up"==d?-1:1,a.currentAnimation==e.TEX_CENTI_BODY&&a.gotoAndStop(e.TEX_CENTI_BODY_DOWN))};c.hitTestShot=function(a){this.headShot=!1;this.deadSegments=[];var d=!1,g=Math.abs(a.x+(a.width>>1)-this.head.display.x-(this.head.display.width>>2)),c=Math.abs(a.y-this.head.display.y);if(g<0.4*this.head.display.width&&c<this.head.display.height)if(d=this.headShot=!0,0==this.segmentList.length)this.isDead=
!0,this.deadSegments.push(this.head);else{var b=this.segmentList.shift(),a=this.head.display.x,g=this.head.display.y;this.head.display.x=b.x;this.head.display.y=b.y;b.x=a;b.y=g;"down"!=b.currentDir&&this.head.setCurrentDir(b.currentDir);this.deadSegments.push(b);this.stage.removeChild(b)}else{for(var e,i=0,h=this.segmentList.length;i<h;i++)b=this.segmentList[i],g=Math.abs(a.x+(a.width>>1)-b.x-(b.width>>2)),c=Math.abs(a.y-b.y),!d&&(g<0.4*b.width&&c<b.height&&1==b.alpha)&&(d=!0,e=i,this.deadSegments=
[]),e<=i&&this.deadSegments.push(b);0<=e&&(this.segmentList.length=e)}return d};c.kill=function(){this.head.destroy();for(var a=0,d=this.segmentList.length;a<d;a++)segment=this.segmentList[a],this.stage.removeChild(segment);this.isDead=!0};c.stop=function(){this.head.display.stop();for(var a=0,d=this.segmentList.length;a<d;a++)segment=this.segmentList[a],segment.stop()};c.play=function(){this.head.display.play();for(var a=0,d=this.segmentList.length;a<d;a++)segment=this.segmentList[a],segment.play()};
c.setPosition=function(a,d){this.head.x=a;this.head.y=d};c.destroy=function(){this.head.destroy();this.isDead=!0;for(var a=0,d=this.segmentList.length;a<d;a++)this.stage.removeChild(this.segmentList[a]);this.segmentList.length=0;this.onShotCallback=null};h.currentGame.Centipede=b})(window.Atari);(function(h){var b=function(a,d){this.initialize(a,d)},a=h.currentGame,e=a.Assets,c=b.prototype;c.mushroomSeed;c.stage;c.bg;c.display;c.speed;c.isDead;c.shotByPlayer;c.audio;c.hitBox;c.initialize=function(a,d){this.stage=a;this.bg=d;this.speed=4+Math.min(d.MAX_SPEED,2*(CurrentGame.globalLevel-1));this.mushroomSeed=0.05;this.display=e.getBitmapAnimation(e.TEX_FLEA,!0);this.stage.addChild(this.display);this.damage=0;this.display.alpha=0;this.hitBox=new Rectangle(0,0,d.rowWidth,d.rowHeight)};c.tick=
function(a){this.hitBox.y+=this.speed*a;this.hitBox.y>4*this.bg.rowHeight&&0==this.display.alpha&&Tween.get(this.display).to({alpha:1},350);Math.random()<this.mushroomSeed&&this.bg.addMushroomAt(this.hitBox.x,this.hitBox.y-this.hitBox.height);this.checkBounds()};c.checkBounds=function(){this.hitBox.y>a.height+this.hitBox.height?this.kill():(this.display.x=this.hitBox.x+(this.hitBox.width>>1),this.display.y=this.hitBox.y)};c.shot=function(){this.damage++;1<this.damage?(this.shotByPlayer=!0,this.kill()):
Tween.get(this.display).to({scaleX:1.35,scaleY:1.35},100,Ease.quadOut).to({scaleX:1,scaleY:1},200,Ease.quadIn);return this.isDead};c.kill=function(){this.isDead=!0;this.stage.removeChild(this.display)};c.setPosition=function(a,d){this.hitBox.x=a;this.hitBox.y=d;this.checkBounds()};h.currentGame.Flea=b})(window.Atari);(function(h){var b=function(a,d,g){this.initialize(a,d,g)},a=h.currentGame,e=a.Assets;b.LEFT="left";b.RIGHT="right";var c=b.prototype;c.yVector;c.xVector;c.dir;c.turnSeed;c.stage;c.display;c.speed;c.isDead;c.minY;c.hitBox;c.initialize=function(a,d,g){this.stage=a;this.bg=d;this.speed=6+Math.min(d.MAX_SPEED,2*(CurrentGame.globalLevel-1));this.turnSeed=0.1;this.yVector=this.xVector=1;this.minY=g;this.display=e.getBitmapAnimation(e.TEX_SPIDER_LEFT,!0);this.display.height*=0.5;this.stage.addChild(this.display);
this.hitBox=new Rectangle(0,0,3*d.rowWidth,d.rowHeight)};c.tick=function(a){this.dir==b.LEFT&&this.display.currentAnimation!=e.TEX_SPIDER_LEFT?this.display.gotoAndPlay(e.TEX_SPIDER_LEFT):this.dir==b.RIGHT&&this.display.currentAnimation!=e.TEX_SPIDER_RIGHT&&this.display.gotoAndPlay(e.TEX_SPIDER_RIGHT);var d=this.dir==b.LEFT?-this.speed:this.speed,d=d*this.xVector,g=this.speed,g=g*this.yVector;this.hitBox.x+=d*a;this.hitBox.y+=g*a;0.05>Math.random()&&this.changeDirection();(a=this.bg.getMushroomByPosition(this.hitBox.x+
(this.hitBox.width>>1),this.hitBox.y))&&this.bg.removeMushroom(a);this.checkBounds()};c.changeDirection=function(){this.xVector=0.35<Math.random()?1:0;var a=Math.random();this.yVector=0.33>a?-1:0.66>a&&0!=this.xVector?0:1;0==this.yVector&&0==this.xVector&&(this.yVector=this.xVector=1)};c.checkBounds=function(){this.dir==b.LEFT&&this.hitBox.x<-this.hitBox.width?this.kill():this.dir==b.RIGHT&&this.hitBox.x>a.width+this.hitBox.width?this.kill():(this.hitBox.y<this.minY?this.yVector=1:this.hitBox.y>a.height-
this.hitBox.height&&(this.yVector=-1),this.display.x=this.hitBox.x+(this.hitBox.width>>1),this.display.y=this.hitBox.y)};c.setPosition=function(a,d){this.hitBox.x=a;this.hitBox.y=d;this.checkBounds()};c.kill=function(){this.isDead=!0;this.stage.removeChild(this.display)};h.currentGame.Spider=b})(window.Atari);(function(h){var b=function(a,d){this.initialize(a,d)},a=h.currentGame,e=a.Assets;b.LEFT="left";b.RIGHT="right";var c=b.prototype;c.dir;c.stage;c.display;c.speed;c.isDead;c.hitBox;c.initialize=function(a,d){this.stage=a;this.bg=d;this.speed=4+Math.min(d.MAX_SPEED,2*(CurrentGame.globalLevel-1));this.display=e.getBitmapAnimation(e.TEX_SCORPION,!0);this.stage.addChild(this.display);this.hitBox=new Rectangle(0,0,2.5*d.rowWidth,d.rowHeight)};c.tick=function(a){this.dir==b.LEFT?this.hitBox.x-=this.speed*
a:(this.hitBox.x+=this.speed*a,1==this.display.scaleX&&(this.display.scaleX=-1));(a=this.bg.getMushroomByPosition(this.hitBox.x+(this.hitBox.width>>1),this.hitBox.y))&&this.bg.poisonMushroom(a);this.checkBounds()};c.checkBounds=function(){this.dir==b.LEFT&&this.hitBox.x<-this.hitBox.width/2?this.kill():this.dir==b.RIGHT&&this.hitBox.x>a.width+this.hitBox.width?this.kill():(this.display.x=this.hitBox.x+(this.hitBox.width>>1),this.display.y=this.hitBox.y)};c.setPosition=function(a,d){this.hitBox.x=
a;this.hitBox.y=d;this.checkBounds()};c.kill=function(){this.isDead=!0;this.stage.removeChild(this.display)};h.currentGame.Scorpion=b})(window.Atari);(function(h){var b=function(){},a=b.prototype,e=h.currentGame,c=e.Assets,f,d=[];a.MAX_SPEED=14;a.game;a.mushroomGrid;a.rowWidth;a.rowHeight;a.rowCount;a.colCount;a.mushroomContainer;a.mushroomRowArray;a.playerRows;a.minPlayerY;a.startFrame;a.startFramePoisoned;a.repairTimeout;a.initialize=function(g){this.game=g;this.mushroomContainer=new Container;g.stage.addChild(this.mushroomContainer);g=c.getBitmap(c.TEX_MUSHROOM);g.width=28;this.rowWidth=this.rowHeight=g.width;this.startFrame=g.currentFrame;
g.gotoAndStop(c.TEX_MUSHROOM_POISONED);this.startFramePoisoned=g.currentFrame;this.rowCount=e.height/this.rowHeight|0;this.colCount=e.width/this.rowHeight|0;this.mushroomRowArray=[];for(g=0;g<this.rowCount;g++){var d=new Container;this.mushroomContainer.addChild(d);this.mushroomRowArray.push(d)}a.mushroomGrid=[];this.playerRows=5;this.minPlayerY=e.height-this.rowHeight*this.playerRows;f=new GameLibs.ProximityManager(50);setTimeout(Atari.proxy(this.wiggleMushroom,this),1E3)};a.wiggleMushroom=function(){var a=
this.mushroomRowArray.length*Math.random()|0,d=this.mushroomRowArray[a].getNumChildren()*Math.random()|0;if((a=this.mushroomRowArray[a].getChildAt(d))&&!(0<a.damage))a.currentAnimation==c.TEX_MUSHROOM?a.gotoAndPlay(c.TEX_MUSHROOM_MOVE):a.currentAnimation==c.TEX_MUSHROOM_POISONED&&a.gotoAndPlay(c.TEX_MUSHROOM_POISONED_MOVE),a.onAnimationEnd=Atari.proxy(this.onWiggleComplete,a),setTimeout(Atari.proxy(this.wiggleMushroom,this),100+100*Math.random())};a.onWiggleComplete=function(){0.75<Math.random()||
(this.currentAnimation==c.TEX_MUSHROOM_MOVE?this.gotoAndPlay(c.TEX_MUSHROOM):this.currentAnimation==c.TEX_MUSHROOM_POISONED_MOVE&&this.gotoAndPlay(c.TEX_MUSHROOM_POISONED))};a.reset=function(){var a,d;a=0;for(d=this.mushroomRowArray.length;a<d;a++)this.mushroomRowArray[a].removeAllChildren();a=0;for(d=this.mushroomGrid.length;a<d;a++)if(this.mushroomGrid[a])for(var c=0,b=this.mushroomGrid[a].length;c<b;c++)this.mushroomGrid[a][c]=null;f.removeAllItems()};a.repairMushrooms=function(a){this.onMushroomRepairComplete=
a;for(var d=0;b<e;b++)for(var b=0,e=this.mushroomRowArray[0].getNumChildren();b<e;b++){var a=this.mushroomRowArray[0].getChildAt(b),f=this.game;(0<a.damage||a.isPoisoned)&&function(a,g){setTimeout(function(){a.gotoAndStop(c.TEX_MUSHROOM);a.isPoisoned=!1;a.damage=0;g.addToScore(5)},100*++d)}(a,f)}var b=Math.max(100*++d+750,1E3),h=this;setTimeout(function(){h.onMushroomRepairComplete();h.onMushroomRepairComplete=null},b)};a.createMushrooms=function(a){for(var d=2;d<this.rowCount-4;d++)for(var c=0;c<
this.colCount;c++)Math.random()>a||this.addMushroomAt(c*this.rowWidth,d*this.rowHeight)};a.getGridPoint=function(a,d){return new Point((a/this.rowWidth|0)*this.rowWidth+this.rowWidth/2,(d/this.rowHeight|0)*this.rowHeight+this.rowHeight/2)};a.getMushroomByPosition=function(a,d){var c=d/this.rowHeight|0,b=a/this.rowWidth|0;return null!=this.mushroomGrid[c]?this.mushroomGrid[c][b]:null};a.addMushroomAt=function(a,d){var b=this.getGridPoint(a,d),e=d/this.rowHeight|0,i=a/this.rowWidth|0;if(!(5>e||e>=this.rowCount-
3)&&!(null!=this.mushroomGrid[e]&&null!=this.mushroomGrid[e][i])){var h=c.getBitmap(c.TEX_MUSHROOM);h.gridPoint=b;h.x=b.x-this.rowWidth+4;h.y=b.y-this.rowHeight;h.col=i;h.row=e;h.damage=0;null==this.mushroomGrid[e]&&(this.mushroomGrid[e]=[]);this.mushroomGrid[e][i]=h;this.mushroomRowArray[e].addChild(h);f.addItem(h);f.refresh();h.hitBox=new Rectangle(i*this.rowWidth+2,e*this.rowHeight+2,this.rowWidth,this.rowHeight)}};a.getBottomMushroomCount=function(){for(var a=0,d=this.minPlayerY,c=0,b=this.mushroomRowArray.length;c<
b;c++)for(var e=0,f=this.mushroomRowArray[c].getNumChildren();e<f;e++)m=this.mushroomRowArray[c].getChildAt(e),m.y>d&&a++;return a};a.poisonMushroom=function(a){a.isPoisoned=!0;0==a.damage?a.gotoAndStop(c.TEX_MUSHROOM_POISONED):a.gotoAndStop(c.TEX_MUSHROOM_POISONED_DAMAGE+(a.damage+1))};a.shootMushroom=function(a){a=this.hitTest(a);if(!a)return null;if(3>a.damage){a.damage++;!0==a.isPoisoned?a.gotoAndStop(c.TEX_MUSHROOM_POISONED_DAMAGE+(a.damage+1)):a.gotoAndStop(c.TEX_MUSHROOM_DAMAGE+(a.damage+1));
var d=0.5*(1.35*a.width-a.width);Tween.get(a).to({x:a.x-d,y:a.y-2*d,scaleX:1.35,scaleY:1.35},200,Ease.quartOut).to({scaleX:1,x:a.gridPoint.x-this.rowWidth+4,scaleY:1,y:a.gridPoint.y-this.rowHeight},100,Ease.quartOut)}else this.removeMushroom(a);SoundJS.play(e.Assets.SND_MUSHROOM_HIT);d=c.getBitmapAnimation(c.TEX_EXPLOSION_PURPLE,!0);d.x=a.x+this.rowWidth;d.y=a.y+this.rowHeight;d.scaleX=d.scaleY=0.75+0.5*Math.random();d.onAnimationEnd=Atari.proxy(this.onExplosionComplete,this,d);this.game.stage.addChild(d);
return a};a.onExplosionComplete=function(a){this.game.stage.removeChild(a)};a.removeMushroom=function(a){this.mushroomGrid[a.row][a.col]=null;this.mushroomRowArray[a.row].removeChild(a);var c=d.indexOf(a);-1<c&&d.splice(c,1);f.removeItem(a);f.refresh()};a.hitTest=function(a){for(var d=f.getNeighbours(a),c,b,e,h,p=0,r=d.length;p<r;p++)if(e=d[p],h=e.hitBox,c=a.x+a.width/2-(h.x+h.width/2),b=a.y+a.height/2-(h.y+h.height/2),Math.abs(c)<=(h.width+a.width)/2&&Math.abs(b)<=(h.height+a.height)/2)return e};
a.getNeighbours=function(a){return f.getNeighbours(a)};a.getMushroomArray=function(){for(var a=[],d,c=0,b=this.mushroomGrid.length;c<b;c++)if(d=this.mushroomGrid[c])for(var e=0,f=d.length;e<f;e++)d[e]&&a.push(d[e]);return a};h.currentGame.BG=b})(window.Atari);(function(h){var b=function(){},a=b.prototype,e=h.currentGame,c=e.Assets,f=GameLibs.GamePad,d,g;a.playerSpeed;a.shotSpeed;a.display;a.width;a.height;a.currentShot;a.minY;a.isDead;a.lives;a.hitBox;a.shotHitBox;a.tweenDisplay;a.initialize=function(a,b){g=b;d=a;this.minY=g.minPlayerY;this.playerSpeed=11;this.shotSpeed=25;this.rowHeight=g.rowHeight;this.display=c.getBitmap(c.TEX_PLAYER_IDLE);this.display.onAnimationEnd=Atari.proxy(this.onAnimationEnd,this);this.width=this.display.width;this.height=this.display.height;
this.hitBox=new Rectangle(0,0,g.rowWidth,g.rowHeight);this.shotHitBox=new Rectangle(0,0,g.rowWidth>>1,g.rowHeight>>1);this.lastShotTime=Ticker.getTime();d.addChild(this.display)};a.onAnimationEnd=function(){if("idleState"==this.state)this.display.gotoAndStop(c.TEX_PLAYER_IDLE);else if("walkingState"==this.state)f.player.isButtonDown(f.LEFT)?this.display.gotoAndPlay(c.TEX_PLAYER_WALK_LEFT):this.display.gotoAndPlay(c.TEX_PLAYER_WALK_RIGHT);else if("dyingState"==this.state){var a=this.display.spriteSheet._data[this.display.currentAnimation].frames;
this.display.gotoAndStop(a[a.length-1])}};a.reset=function(a,d){var b=e.width-this.width+20>>1,h=e.height-this.height;d?(Tween.get(this.hitBox).to({x:b,y:h},1E3,Ease.quadOut),this.tweenDisplay=Tween.get(this.display).to({x:b,y:h-this.display.height+g.rowHeight},1E3,Ease.quadOut).call(function(){this.tweenDisplay=null},null,this)):null==this.tweenDisplay&&this.setPosition(b,h);(b=g.getMushroomByPosition(this.hitBox.x+this.hitBox.width/2,this.hitBox.y+this.hitBox.height/2))&&g.removeMushroom(b);if(this.isDead||
a)this.isDead=!1,this.display.alpha=0,Tween.get(this.display).to({alpha:1},500);this.state="idleState";this.display.gotoAndStop(c.TEX_PLAYER_IDLE);this.removeShot();f.player.setButtonUp(f.BUTTON_1)};a.setPosition=function(a,d){this.hitBox.x=a;this.hitBox.y=d;this.display.x=a;this.display.y=d-this.height+g.rowHeight};a.kill=function(){if("dyingState"!=this.state){this.state="dyingState";this.isDead=!0;this.lives--;this.display.gotoAndPlay(c.TEX_PLAYER_DEATH);this.removeShot();SoundJS.play(e.Assets.SND_PLAYER_HIT);
var a=c.getBitmapAnimation(c.TEX_DEATH_SMOKE,!0);a.x=this.display.x+(this.width>>1);a.y=this.display.y+(this.height>>1);a.onAnimationEnd=Atari.proxy(this.onExplosionComplete,this,a);d.addChild(a)}};a.onExplosionComplete=function(a){d.removeChild(a)};a.tick=function(a){this.updateShot(a);"dyingState"!=this.state&&(null==this.display.parent&&d.addChild(this.display),this.movePlayer(a),this.display.currentAnimation!=c.TEX_PLAYER_ATTACK&&("idleState"==this.state?this.display.gotoAndStop(c.TEX_PLAYER_IDLE):
"walkingState"==this.state&&(this.display.currentAnimation!=c.TEX_PLAYER_WALK_LEFT&&this.display.currentAnimation!=c.TEX_PLAYER_WALK_RIGHT)&&(f.player.isButtonDown(f.LEFT)?this.display.gotoAndPlay(c.TEX_PLAYER_WALK_LEFT):this.display.gotoAndPlay(c.TEX_PLAYER_WALK_RIGHT))))};a.movePlayer=function(a){var d=this.playerSpeed*a,c=0,a=0;this.state="idleState";f.player.isButtonDown(f.LEFT)&&(this.state="walkingState",c=-d);f.player.isButtonDown(f.RIGHT)&&(this.state="walkingState",c=d);f.player.isButtonDown(f.UP)&&
(this.state="walkingState",a=-d);f.player.isButtonDown(f.DOWN)&&(this.state="walkingState",a=d);if((d=e.instance.joystick)&&d.buttonActive)d=d.currentAmount,c*=Math.abs(d.x),a*=Math.abs(d.y);this.hitBox.x+=c;this.hitBox.x=Math.min(e.width-this.hitBox.width,Math.max(this.hitBox.x,0));var b,h,p=0,r=0,c=b=0,l,c=this.hitBox.width/2,d=this.hitBox.height/2,q=g.getNeighbours(this.hitBox);b=0;for(h=q.length;b<h;b++)if(l=q[b].hitBox?q[b].hitBox:q[b],p=l.x+l.width/2-(this.hitBox.x+c),r=l.y+l.height/2-(this.hitBox.y+
d),Math.abs(p)<l.width/2+c&&Math.abs(r)<l.height/2+d){this.hitBox.x+=p;b=0<p?-g.rowWidth:g.rowWidth;this.hitBox.x+=b;break}this.hitBox.y+=a;this.hitBox.y=Math.min(e.height-this.hitBox.height,Math.max(this.hitBox.y,this.minY+this.hitBox.height));q=g.getNeighbours(this.hitBox);b=0;for(h=q.length;b<h;b++)if(l=q[b].hitBox?q[b].hitBox:q[b],p=l.x+l.width/2-(this.hitBox.x+c),r=l.y+l.height/2-(this.hitBox.y+d),Math.abs(p)<l.width/2+c&&Math.abs(r)<l.height/2+d){this.hitBox.y+=r;c=0<r?-g.rowHeight:g.rowHeight;
this.hitBox.y+=c;break}this.display.x=this.hitBox.x;this.display.y=this.hitBox.y-this.display.height+g.rowHeight};a.updateShot=function(a){if(this.currentShot)if(this.currentShot.lastY=this.currentShot.hitBox.y,this.currentShot.y-=this.currentShot.velY*a,this.currentShot.hitBox.y=this.currentShot.y+2*this.currentShot.hitBox.height,this.currentShot.velY*=1.05,this.currentShot.y<-this.currentShot.height)this.removeShot();else{if(this.onShotCallback)for(var a={width:this.currentShot.hitBox.width,height:this.currentShot.hitBox.height,
regX:this.currentShot.regX,regY:this.currentShot.regY,x:this.currentShot.hitBox.x},b=this.currentShot.hitBox.y,e=(this.currentShot.lastY-b)/3,g=0;3>g;g++)if(a.y=b+e*g,this.onShotCallback(a)){this.removeShot();break}}else f.player.isButtonDown(f.BUTTON_1)&&100<Ticker.getTime()-this.lastShotTime&&(this.currentShot=c.getBitmapAnimation(c.TEX_SHOT),this.currentShot.scaleX=this.currentShot.scaleY=0.8,this.currentShot.x=this.display.x+(this.display.width-(this.currentShot.width>>1)),this.currentShot.y=
this.display.y-10,this.currentShot.velY=this.shotSpeed,this.currentShot.hitBox=this.shotHitBox,this.currentShot.hitBox.x=this.currentShot.x+(this.currentShot.width>>1)-(this.shotHitBox.width>>1),this.currentShot.hitBox.y=this.currentShot.y+2*this.currentShot.hitBox.height,d.addChild(this.currentShot),d.swapChildren(this.display,this.currentShot),this.display.gotoAndPlay(c.TEX_PLAYER_ATTACK),SoundJS.play(c.SND_SHOOT),this.lastShotTime=Ticker.getTime())};a.removeShot=function(){null!=this.currentShot&&
(d.removeChild(this.currentShot),this.currentShot=null)};h.currentGame.Player=b})(window.Atari);(function(h){var b=function(a,c){this.initialize(a,c)};Assets=h.Assets;var a=b.prototype;a.stage;a.game;a.livesText;a.livesLabel;a.gnomeSprite;a.scoreLabel;a.scoreText;a.scoreManager;a.levelLabel;a.levelText;a.padding;a.labelSize;a.textSize;a.display;a.initialize=function(a,c){this.game=a;this.stage=a.stage;this.display=new Container;this.stage.addChild(this.display);this.labelSize=14;this.textSize=40;this.padding=10;this.scoreLabel=this.createTextField("SCORE",this.labelSize,this.padding+1,45+this.labelSize/
2,"#51c4fc");this.scoreText=this.createTextField("0",this.textSize,this.padding,15+this.textSize/2);this.scoreManager=new GameLibs.ScoreManager(this.scoreText);this.levelLabel=this.createTextField("LEVEL",this.labelSize,c.width/2-20,45+this.labelSize/2,"#51c4fc");this.levelText=this.createTextField("1-1",this.textSize,c.width/2-25,15+this.textSize/2);this.gnomeSprite=new Bitmap(a.assets[Assets.HUD_GNOME]);this.gnomeSprite.x=c.width-100;this.gnomeSprite.y=5;this.display.addChild(this.gnomeSprite);
this.livesLabel=this.createTextField("LIVES",this.labelSize,c.width-70,45+this.labelSize/2,"#51c4fc");this.livesText=this.createTextField("x3",this.textSize,c.width-70,15+this.textSize/2)};a.setLives=function(a){this.currentLives!=a&&(this.currentLives=a,this.livesText.text="x"+a)};a.setScore=function(a){this.scoreManager.setScore(a)};a.setLevel=function(a){this.levelText.text=a};a.createTextField=function(a,c,b,d,g){null==g&&(g="#ffffff");a=new Text(a,c+"px "+Atari.Fonts.DEMI,g);a.textBaseline="alphabetic";
a.x=b||0;a.y=d||0;this.display.addChild(a);return a};h.HUD=b})(Atari.currentGame);(function(h){var b=function(a,b){this.initialize(a,b)};b.instance;CurrentGame=h.currentGame;CurrentGame.globalLevel=1;var a=b.prototype;a.state;a._currentLevel;a.data;a.game;a.player;a.bg;a.stage;a.centipedeList;a.levelHues;a.isLevelPending;a.nextFleaSpawn=-1;a.nextSpiderSpawn=-1;a.nextScorpionSpawn=-1;a.nextCentipedeSpawn=-1;a.levelText;a.levelTextUnderlay;a.levelTextX;a.levelHues;a.startingLives=3;a.extraLifeScore=12500;a.nextExtraLife;a.gameOverSound;a.repairSound;a.minScorpionLevel=3;a.minSpiderSpawn=
3E3;a.minScorpionSpawn=5E3;a.minCentipedeSpawn=1E4;a.textureContexts;a.initialize=function(a,c){b.instance=this;Assets=c.Assets;this.textureContexts=[];this.game=a;this.data=c;this.player=a.player;this.bg=a.bg;this.stage=a.stage;this.centipedeList=a.centipedeList;this.levelTextUnderlay=new Shape;this.levelTextUnderlay.graphics.beginFill("#000000");this.levelTextUnderlay.graphics.drawRect(0,0,a.width,a.height);a.stage.addChild(this.levelTextUnderlay);this.levelText=new Text("Level 1","40px "+Atari.Fonts.DEMI,
"#FFFFFF");this.levelText.x=this.levelTextX=430;this.levelText.y=a.height/2-75;a.stage.addChild(this.levelText);this.initHueShift()};a.startGame=function(){this.bg.reset();this.bg.createMushrooms(0.05);this.bg.addMushroomAt(512,100);this.player.reset();this.player.lives=this.startingLives;this.game.hud.setLives(this.player.lives);this.game.currentScore=0;this.game.hud.setScore(this.game.currentScore);this.nextExtraLife=this.extraLifeScore;this._currentLevel=1;SoundJS.play(CurrentGame.Assets.SND_GAMESTART);
this.startCurrentLevel(!0);this.gameOverSound&&this.gameOverSound.stop();this.repairSound&&this.repairSound.stop()};a.reset=function(){this._currentLevel=1;CurrentGame.globalLevel=1;this.game.hud.setLevel(CurrentGame.globalLevel+"-"+this._currentLevel)};a.startCurrentLevel=function(a){this.state="startingLevel";this.game.isPaused=!0;this.game.removeEnemies();this.player.reset();a?(this.levelTextUnderlay.alpha=0,Tween.get(this.levelTextUnderlay).wait(300).to({alpha:0.5},500).wait(1E3).to({alpha:0},
500),this.levelText.text="Level "+this._currentLevel,this.levelText.x=this.game.width,Tween.get(this.levelText).wait(500).to({x:this.levelTextX},500,Ease.backOut).wait(1E3).to({x:-this.game.width/2},500,Ease.backIn),setTimeout(Atari.proxy(this.updateColorPalette,this),1E3),setTimeout(Atari.proxy(this.startLevelNow,this),2500)):setTimeout(Atari.proxy(this.startLevelNow,this),1500)};a.startLevelNow=function(){this.state="playingGame";this.game.isPaused=!1;this.game.player.reset();for(var a=(this.bg.colCount>>
1)*this.bg.rowWidth-this.bg.rowHeight/2,b=this.game.createCentipede(12-this._currentLevel,a,2*this.bg.rowHeight+this.bg.rowHeight/2,!0),f=1;f<this._currentLevel;f++){var a=0.5<Math.random()?-50+-50*Math.random():this.game.width+50+50*Math.random(),d=this.bg.getGridPoint(a,3*this.bg.rowHeight+2*this.bg.rowHeight*Math.random()),b=this.game.createCentipede(0,d.x,d.y);b.head.setCurrentDir(0>a?"left":"right");b.head.nextPoint={x:d.x,y:d.y};b.head.nextPoint.x+=0>a?100:-100}this.game.hud.setLevel(CurrentGame.globalLevel+
"-"+this._currentLevel);a=1;a=10<=this._currentLevel?0:1-this._currentLevel/10;Tween.get(this.game.dayBg).to({alpha:a},500);CurrentGame.BackgroundSound.update()};a.continueGame=function(){this.gameOverSound.stop();this.player.lives=this.startingLives;this.game.hud.setLives(this.player.lives);this.startCurrentLevel()};a.initHueShift=function(){};a.updateColorPalette=function(){};a.onPlayerKilled=function(){this.game.removeEnemies();this.repairSound=SoundJS.play(Assets.SND_REPAIR,null,0,0,-1);this.lastFleaSound&&
this.lastFleaSound.stop();this.bg.repairMushrooms(Atari.proxy(this.onRepairMushroomsComplete,this))};a.onRepairMushroomsComplete=function(){this.game.removeEnemies();this.repairSound.stop();0>=this.player.lives?(h.currentGame.BackgroundSound.stop(),this.gameOverSound=SoundJS.play(Assets.SND_GAMEOVER),this.game.onGameOver()):this.startCurrentLevel(!1)};a.tick=function(a){this.tickFactor=a;this.updateFlea();this.updateSpider();this.updateScorpion();this.updateCentipedes();0==this.centipedeList.length&&
"startingLevel"!=this.state&&this.nextLevel()};a.nextLevel=function(){SoundJS.play(Assets.SND_LEVELCOMPLETE);this._currentLevel++;12<this._currentLevel&&(this._currentLevel=1,CurrentGame.globalLevel++);this.player.reset(!1,!0);this.startCurrentLevel(!0)};a.checkExtraLives=function(){this.game.currentScore>this.nextExtraLife&&(this.game.player.lives++,this.game.hud.setLives(this.game.player.lives),this.nextExtraLife+=this.extraLifeScore,SoundJS.play(Assets.SND_EXTRA_LIFE))};a.updateCentipedes=function(){for(var a=
!1,b=this.centipedeList.length-1;0<=b;b--)if(this.centipedeList[b].isDead)this.centipedeList[b].destroy(),this.centipedeList.splice(b,1);else if(this.centipedeList[b].tick(this.tickFactor),this.centipedeList[b].head.isPoisoned&&!a&&(a=!0),this.centipedeList[b].head.y>=this.bg.minPlayerY)if(-1==this.nextCentipedeSpawn)this.nextCentipedeSpawn=Ticker.getTime()+this.minCentipedeSpawn+this.minCentipedeSpawn*Math.random();else if(-1!=this.nextCentipedeSpawn&&Ticker.getTime()>this.nextCentipedeSpawn){var f=
0.5<Math.random()?-50:this.game.width+50,d=this.bg.getGridPoint(f,this.bg.minPlayerY),g=this.game.createCentipede(0,d.x,d.y);g.head.setCurrentDir(0>f?"left":"right");g.head.nextPoint={x:d.x,y:d.y};g.head.nextPoint.x+=0>f?100:-100;this.nextCentipedeSpawn=-1}};a.updateFlea=function(){var a=this.game.currentFlea;null!=a?a.isDead?(!0==a.shotByPlayer&&(this.nextFleaSpawn=Ticker.getTime()+100),this.game.currentFlea=null,this.lastFleaSound&&this.lastFleaSound.stop(),this.lastFleaSound=null):a.tick(this.tickFactor):
-1==this.nextFleaSpawn&&5>this.bg.getBottomMushroomCount()&&1<this.game.centipedeList.length?this.nextFleaSpawn=Ticker.getTime()+3E3+4E3*Math.random():-1!=this.nextFleaSpawn&&Ticker.getTime()>this.nextFleaSpawn&&(this.game.createFlea(),this.lastFleaSound=SoundJS.play(Assets.SND_FLEA,null,0,0,0,1),this.lastFleaSound.onComplete=Atari.proxy(this.fleaSoundComplete,this),this.nextFleaSpawn=-1)};a.fleaSoundComplete=function(){this.lastFleaSound=null};a.updateSpider=function(){var a=this.game.currentSpider;
a?(a.tick(this.tickFactor),a.isDead&&(this.game.currentSpider=null,CurrentGame.BackgroundSound.update())):-1==this.nextSpiderSpawn&&1<=this._currentLevel?this.nextSpiderSpawn=Ticker.getTime()+this.minSpiderSpawn+this.minSpiderSpawn*Math.random():-1!=this.nextSpiderSpawn&&Ticker.getTime()>this.nextSpiderSpawn&&(this.nextSpiderSpawn=-1,this.game.createSpider(),CurrentGame.BackgroundSound.update())};a.updateScorpion=function(){var a=this.game.currentScorpion;a?(a.tick(this.tickFactor),a.isDead&&(this.game.currentScorpion=
null,CurrentGame.BackgroundSound.update())):-1==this.nextScorpionSpawn&&this._currentLevel>=this.minScorpionLevel?this.nextScorpionSpawn=Ticker.getTime()+this.minScorpionSpawn+this.minScorpionSpawn*Math.random():-1!=this.nextScorpionSpawn&&Ticker.getTime()>this.nextScorpionSpawn&&(this.game.createScorpion(),CurrentGame.BackgroundSound.update(),this.nextScorpionSpawn=-1)};a.removeSpawnTimers=function(){this.nextScorpionSpawn=this.nextSpiderSpawn=this.nextFleaSpawn=this.nextCentipedeSpawn=-1};h.currentGame.LevelManager=
b})(window.Atari);(function(h){var b=function(){},a=b.prototype,e=h.currentGame,c=e.Assets,f=GameLibs.GamePad;a.debugMode=!1;a.debugShape=null;a.lastTick;a.levelManager;a.proximityManager;a.stage;a.hud;a.bg;a.player;a.spritesBehind;a.spritesInFront;a.isPaused;a.isPlayerDead;a.currentScore;a.centipedeList=[];a.currentSpider;a.currentFlea;a.currentScorpion;a.lastLengthChecked=0;a.lastPoisonChecked=!1;a.joystick=null;a.initialize=function(a,b,j){this.assets=a;var h=a.TextureSheet,s;for(s in h.animations)h.animations[s].frequency=
3;c.textureSheet=new GameLibs.SpriteSheetWrapper(h,"images/");this.stage=b;this.width=e.width=this.stage.canvas.width;this.height=e.height=this.stage.canvas.height;this.dayBg=new Bitmap(a.backgroundDay);this.stage.addChild(this.dayBg);a=GameLibs.GameUI.changeBackground(a.background,j.width,j.height);b.addChildAt(a,0);Ticker.setFPS(60);this.lastTick=Ticker.getTime();this.spritesBehind=new Container;this.stage.addChild(this.spritesBehind);this.bg=new e.BG;this.bg.initialize(this);this.spritesInFront=
new Container;this.stage.addChild(this.spritesInFront);this.player=new e.Player;this.player.initialize(this.spritesInFront,this.bg);this.player.onShotCallback=Atari.proxy(this.hitTestShot,this);e.BackgroundSound.init(this);this.currentScore=0;this.hud=new e.HUD(this,j);this.levelManager=new e.LevelManager(this,e);Atari.developerMode&&(f.player.onButtonDown=Atari.proxy(this.onButtonDown,this));j.touchEnabled&&(b=new GameLibs.SpriteSheetWrapper(this.assets.controls,"images/"),this.joystick=new GameLibs.Joystick(new Rectangle(0,
0,this.width/2,this.height),{controlDirection:!0,autoHide:!1,autoMove:!0,showStick:!1,radius:34},b),this.joystick.setPosition(100,j.height-72),this.fireBtn=new GameLibs.ArcadeButton(GameLibs.GamePad.BUTTON_1,new Rectangle(this.width/2,0,this.width/2,this.height),b,"fire"),this.fireBtn.setPosition(j.width-124,j.height-72),this.stage.addChild(this.joystick.sprite,this.fireBtn.sprite));this.debugMode&&(this.debugShape=new Shape,this.stage.addChild(this.debugShape))};a.snipe=function(){this.levelManager.nextLevel()};
a.startGame=function(){this.levelManager.startGame();this.hud.setLives(this.player.lives);this.hud.setScore(this.currentScore)};a.endGame=function(){this.cleanUp()};a.cleanUp=function(){this.currentScore=0;this.hud.setScore(this.currentScore);this.levelManager.reset();this.removeEnemies();this.bg.reset()};a.pause=function(a){(this.isPaused=a)?(h.currentGame.BackgroundSound.pause(),this.levelManager.lastFleaSound&&this.levelManager.lastFleaSound.pause()):(h.currentGame.BackgroundSound.resume(),this.levelManager.lastFleaSound&&
this.levelManager.lastFleaSound.resume())};a.getScore=function(){return new GameLibs.GameDetails(this.currentScore,this.levelManager._currentLevel,this.player.lives)};a.continueGame=function(a){a||(this.currentScore=0,this.hud.setScore(this.currentScore));h.currentGame.BackgroundSound.init(this);this.levelManager.continueGame()};a.restart=function(){this.cleanUp();h.currentGame.BackgroundSound.init(this);this.startGame()};a.destroy=function(){};a.onLevelComplete=null;a.onGameComplete=null;a.onGameOver=
null;a.onGameError=null;a.onButtonDown=function(a){a==f.BUTTON_2&&this.snipe()};a.tick=function(){if(!this.isPaused&&this.hud)if(this.player.isDead)this.isPlayerDead||(this.isPlayerDead=!0,this.levelManager.onPlayerKilled(),h.currentGame.BackgroundSound.update(),this.hud.setLives(this.player.lives));else{this.isPlayerDead=!1;var a=Math.min(Ticker.getTime()-this.lastTick,50)/30;this.lastTick=Ticker.getTime();this.levelManager.tick(a);this.player.tick(a);this.stage.getChildIndex(this.hud.display)<this.stage.getNumChildren()-
1&&this.stage.setChildIndex(this.hud.display,this.stage.getNumChildren()-1);for(var b=this.centipedeList.concat([this.currentFlea,this.currentScorpion,this.currentSpider]),c=!1,e,a=0,f=b.length;a<f;a++)if(e=b[a])if(-1!=this.centipedeList.indexOf(e)){var i=e.segmentList.concat([e.head]);e=0;for(var t=i.length;e<t;e++)if(c=this.hitTestRects(i[e].hitBox,this.player.hitBox,1)){this.player.kill();break}}else if(c=this.hitTestRects(e.hitBox,this.player.hitBox,1))this.player.kill(),e.kill(),this.addExplosionAt(e.display.x,
e.display.y);if(this.debugMode){this.debugShape.graphics.clear();this.debugShape.graphics.beginStroke("rgba(255,255,255,1)");this.debugShape.graphics.drawRect(this.player.hitBox.x,this.player.hitBox.y,this.player.hitBox.width,this.player.hitBox.height);this.debugShape.graphics.drawRect(this.player.shotHitBox.x,this.player.shotHitBox.y,this.player.shotHitBox.width,this.player.shotHitBox.height);this.currentSpider&&(this.currentSpider.setPosition(this.width>>1,this.height-100),this.debugShape.graphics.drawRect(this.currentSpider.hitBox.x,
this.currentSpider.hitBox.y,this.currentSpider.hitBox.width,this.currentSpider.hitBox.height));this.currentFlea&&(this.currentFlea.setPosition((this.width>>1)-200,this.height-100),this.debugShape.graphics.drawRect(this.currentFlea.hitBox.x,this.currentFlea.hitBox.y,this.currentFlea.hitBox.width,this.currentFlea.hitBox.height));this.currentScorpion&&(this.currentScorpion.setPosition((this.width>>1)+200,this.height-100),this.debugShape.graphics.drawRect(this.currentScorpion.hitBox.x,this.currentScorpion.hitBox.y,
this.currentScorpion.hitBox.width,this.currentScorpion.hitBox.height));e=this.bg.getMushroomArray();a=0;for(f=e.length;a<f;a++)b=e[a],this.debugShape.graphics.drawRect(b.hitBox.x,b.hitBox.y,b.hitBox.width,b.hitBox.height);a=0;for(f=this.centipedeList.length;a<f;a++){b=this.centipedeList[a];this.debugShape.graphics.drawRect(b.head.hitBox.x,b.head.hitBox.y,b.head.hitBox.width,b.head.hitBox.height);e=0;for(k=b.segmentList.length;e<k;e++)c=b.segmentList[e],this.debugShape.graphics.drawRect(c.hitBox.x,
c.hitBox.y,c.hitBox.width,c.hitBox.height)}}}};a.hitTestSprites=function(a,b,c){null==c&&(c=1);c*=0.5;return Math.abs(a.x+0.5*a.width-a.regX-(b.x+0.5*b.width-b.regX))<(a.width+b.width)*c&&Math.abs(a.y+0.5*a.height-a.regY-(b.y+0.5*b.height-b.regY))<(a.height+b.height)*c?!0:!1};a.hitTestRects=function(a,b,c){null==c&&(c=1);c*=0.5;return Math.abs(a.x+0.5*a.width-(b.x+0.5*b.width))<(a.width+b.width)*c&&Math.abs(a.y+0.5*a.height-(b.y+0.5*b.height))<(a.height+b.height)*c?!0:!1};a.hitTestShot=function(a){var b=
!1,f;f=this.bg.shootMushroom(a);null!=f&&(null==f.parent&&this.addToScore(1),b=!0);if(0<this.centipedeList.length)for(f=this.centipedeList.length-1;0<=f;f--){var h=this.centipedeList[f];h.hitTestShot(a)&&(b=h.deadSegments.shift(),this.bg.addMushroomAt(b.x,b.y),this.addExplosionAt(b.x,b.y),this.spritesBehind.removeChild(b),0<h.deadSegments.length?(b=new e.Centipede,b.initialize(this.spritesBehind,this.bg),b.createFromCorpse(h.deadSegments,h.head),this.centipedeList.push(b),this.addToScore(10)):this.addToScore(100),
b=!0)}this.currentFlea&&(f=this.currentFlea.hitBox,h=f.x+(f.width>>1)-(a.x+a.width/2),f.y>=a.y&&Math.abs(h)<(f.width+a.width)/2&&(b=this.currentFlea.shot(),this.addExplosionAt(this.currentFlea.display.x,this.currentFlea.display.y),b&&this.addToScore(200),b=!0));if(this.currentSpider){f=this.currentSpider.hitBox;var h=f.x+(f.width>>1)-(a.x+(a.width>>1)),s=f.y-(a.y+(a.height>>1));Math.abs(h)<f.width>>1&&Math.abs(s)<f.height>>1&&(this.currentSpider.kill(),this.addExplosionAt(this.currentSpider.display.x,
this.currentSpider.display.y),b=!0,f=this.currentSpider.hitBox.y/this.bg.rowHeight|0,f<=this.bg.rowCount-10?(this.addToScore(300),this.addFLoaty(c.TEX_300,this.currentSpider.display.x,this.currentSpider.display.y)):f<=this.bg.rowCount-6?(this.addToScore(600),this.addFLoaty(c.TEX_600,this.currentSpider.display.x,this.currentSpider.display.y)):(this.addToScore(900),this.addFLoaty(c.TEX_900,this.currentSpider.display.x,this.currentSpider.display.y)))}this.currentScorpion&&(f=this.currentScorpion.hitBox,
h=f.x+(f.width>>1)-(a.x+(a.width>>1)),s=f.y-(a.y+(a.height>>1)),Math.abs(h)<f.width>>1&&Math.abs(s)<f.height>>1&&(this.currentScorpion.kill(),this.addExplosionAt(this.currentScorpion.display.x,this.currentScorpion.display.y),b=!0,this.addToScore(900),this.addFLoaty(c.TEX_900,this.currentScorpion.display.x,this.currentScorpion.display.y)));return b};a.addExplosionAt=function(a,b,e){isNaN(e)&&(e=1);var f=c.getBitmapAnimation(c.TEX_EXPLOSION,!0);f.x=a;f.y=b;f.scaleX=f.scaleY=e;this.spritesInFront.addChild(f);
f.onAnimationEnd=this.onExplosionComplete;SoundJS.play(c.SND_EXPLOSION)};a.addFLoaty=function(a,b,e){var f=c.getBitmapAnimation(a,!0);f.spriteSheet.getAnimation(a).next=!1;f.x=b;f.y=e;this.spritesInFront.addChild(f);Tween.get(f).to({y:e-25},500).wait(500).to({alpha:0},350);setTimeout(function(){f.parent.removeChild(f)},1500)};a.onExplosionComplete=function(a){a.parent.removeChild(a)};a.addToScore=function(a){this.currentScore+=a;this.hud.setScore(this.currentScore);this.levelManager.checkExtraLives()};
a.pauseEnemies=function(a){a=a?"stop":"play";"stop"==a&&e.BackgroundSound.pause();if(this.currentFlea)this.currentFlea.display[a]();if(this.currentSpider)this.currentSpider.display[a]();if(this.currentScorpion)this.currentScorpion.display[a]();for(var b=0,c=this.centipedeList.length;b<c;b++)this.centipedeList[b][a]()};a.removeEnemies=function(){this.currentFlea&&(this.currentFlea.kill(),this.currentFlea=null);this.currentSpider&&(this.currentSpider.kill(),this.currentSpider=null);this.currentScorpion&&
(this.currentScorpion.kill(),this.currentScorpion=null);for(var a=0,b=this.centipedeList.length;a<b;a++)this.centipedeList[a].kill();this.centipedeList.length=0;this.levelManager.removeSpawnTimers()};a.createFlea=function(){this.currentFlea=new e.Flea(this.spritesInFront,this.bg);var a=this.bg.getGridPoint(Math.random()*e.width);this.currentFlea.setPosition(a.x,-this.bg.rowHeight)};a.createScorpion=function(){this.currentScorpion=new e.Scorpion(this.spritesInFront,this.bg);var a=this.bg.getGridPoint(0,
5*this.bg.rowHeight+6*this.bg.rowHeight*Math.random());0.5<Math.random()?(a.x=e.width+50,this.currentScorpion.dir=e.Scorpion.LEFT):(a.x=-50,this.currentScorpion.dir=e.Scorpion.RIGHT);this.currentScorpion.setPosition(a.x,Math.round(a.y)+0.5)};a.createSpider=function(){var a=12;18E4<this.currentScore&&86E4>this.currentScore&&(a=6);a=this.height-this.bg.rowHeight*a;this.currentSpider=new e.Spider(this.spritesInFront,this.bg,a);a=this.bg.getGridPoint(0,e.height-a/2);0.5<Math.random()?(a.x=e.width+50,
this.currentSpider.dir=e.Spider.LEFT):(a.x=-50,this.currentSpider.dir=e.Spider.RIGHT);this.currentSpider.setPosition(a.x,a.y)};a.createCentipede=function(a,b,c,f){var h=new e.Centipede;h.initialize(this.spritesBehind,this.bg,this.player);h.createFromScratch(a,b,c,f);this.centipedeList.push(h);return h};h.currentGame.Game=b})(window.Atari);
